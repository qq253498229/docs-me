<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.介绍 :: docs-me</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">docs-me</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs-antora-oauth2.1" data-version="0.0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">OAuth 2.1 授权框架</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="1-introduction.html">1.介绍</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="2-client-registration.html">2.客户端注册</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="3-protocol-endpoints.html">3.协议端点</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="4-grant-types.html">4.授权类型</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="5-resource-requests.html">5.资源请求</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="6-extensibility.html">6.可扩展性</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="7-security-considerations.html">7.安全考虑</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="8-native-applications.html">8.原生应用程序</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="9-section-9.html">9.基于浏览器的应用程序</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="10-differences-from-oauth-20.html">10.与OAuth 2.0的不同之处</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="11-iana-considerations.html">11.IANA考虑因素</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="12-references.html">12.参考文献</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appendix-a.html">附录A</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appendix-b.html">附录B</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appendix-c.html">附录C</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appendix-d.html">附录D</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appendix-e.html">附录E</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="appendix-f.html">附录F</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="authors-addresses.html">作者邮箱</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">OAuth 2.1 授权框架</span>
    <span class="version">0.0.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../docs-config/0.0.1/index.html">docs-config</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-config/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-steam-electron/0.0.1/index.html">docs-steam-electron</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-steam-electron/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-xiuxian/0.0.1/index.html">docs-xiuxian</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-xiuxian/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-es-java/7.16.0/introduction.html">ES Java API Client</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-es-java/7.16.0/introduction.html">7.16.0</a>
        </li>
        <li class="version">
          <a href="../../docs-es-java/6.8.0/preface.html">6.8.0</a>
        </li>
        <li class="version">
          <a href="../../docs-es-java/6.2.2/1Preface/readme.html">6.2.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-greenworks-js/0.0.1/index.html">Greenworks-JS 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-greenworks-js/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-rust-libp2p/0.0.1/index.html">libp2p入门</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-rust-libp2p/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-neutralino-api/0.0.1/index.html">NeutralinoJS 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-neutralino-api/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="index.html">OAuth 2.1 授权框架</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-pd2/0.0.1/index.html">PD2记录</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-pd2/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-peerjs/0.0.1/index.html">PEER JS</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-peerjs/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-actuator/3.3.3/index.html">Spring Boot Actuator</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-actuator/3.3.3/index.html">3.3.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-oauth2/0.0.1/index.html">Spring Boot OAuth2</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-oauth2/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-steamworks-rs/0.11.0/index.html">Steamworks for Rust</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-steamworks-rs/0.11.0/index.html">0.11.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-tauri/v1/index.html">Tauri API 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-tauri/v1/index.html">v1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-testing-angular/中文/start.html">Testing Angular</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-testing-angular/中文/start.html">中文</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-me/0.0.1/index.html">个人记录</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-me/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-taiwu/0.0.1/index.html">太吾绘卷</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-taiwu/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-palworld/0.0.1/index.html">幻兽帕鲁笔记</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-palworld/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-building-event-driven-microservices/0.0.1/index.html">微服务与事件驱动架构</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-building-event-driven-microservices/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-hunter/0.0.1/index.html">猎人-荒野的呼唤</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-hunter/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-logitech/v8.45/index.html">罗技鼠标宏文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-logitech/v8.45/index.html">v8.45</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-milk/0.0.1/index.html">银河奶牛</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-milk/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../docs-me/0.0.1/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">OAuth 2.1 授权框架</a></li>
    <li><a href="1-introduction.html">1.介绍</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/qq253498229/docs-antora-oauth2.1/edit/master/modules/ROOT/pages/1-introduction.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="目录" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">1.介绍</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>OAuth 通过将客户端的角色与资源所有者的角色分离，在客户端 - 服务器认证模型中引入了一个授权层。在 OAuth 中，客户端请求访问由资源所有者控制并由资源服务器托管的资源。客户端不是使用资源所有者的凭据来访问受保护的资源，而是获得一个访问令牌——一个代表特定访问属性（如范围和生命周期）的凭证。访问令牌由授权服务器在获得资源所有者的批准后发放给客户端。客户端使用访问令牌访问资源服务器托管的受保护资源。</p>
</div>
<div class="paragraph">
<p>在更早的、更有限的客户端 - 服务器认证模型中，客户端通过使用资源所有者的凭据向服务器进行认证，请求服务器上的访问受限资源（受保护资源）。为了向应用程序提供对受限资源的访问权限，资源所有者会与应用程序共享其凭据。这带来了以下几个问题和限制：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>应用程序需要存储资源所有者的凭据以供日后使用，通常是明文密码。</p>
</li>
<li>
<p>服务器需要支持密码认证，尽管密码存在固有的安全弱点。</p>
</li>
<li>
<p>应用程序获得对资源所有者受保护资源的过度广泛访问权限，使资源所有者无法限制访问的持续时间或仅限于访问有限的资源子集。</p>
</li>
<li>
<p>资源所有者通常会在其他不相关的服务中重复使用密码，尽管这违反了最佳安全实践。这种密码重复使用意味着一个服务中的漏洞或暴露可能会对完全不相关的服务产生安全影响。</p>
</li>
<li>
<p>资源所有者无法单独撤销对某个应用程序的访问权限，而必须通过更改密码来撤销对所有第三方的访问权限。</p>
</li>
<li>
<p>任何应用程序的被入侵都会导致最终用户的密码被泄露，以及所有由该密码保护的数据被泄露。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>通过 OAuth，最终用户（资源所有者）可以授予打印服务（客户端）访问其在照片分享服务（资源服务器）上受保护的照片的权限，而无需与打印服务共享其用户名和密码。相反，他们可以直接通过照片分享服务信任的服务器（授权服务器）进行认证，该服务器会向打印服务发放特定于委托的凭证（访问令牌）。</p>
</div>
<div class="paragraph">
<p>这种关注点分离还提供了使用更先进的用户认证方法的能力，例如多因素认证，甚至是无密码认证，而无需对应用程序进行任何修改。由于所有用户认证逻辑都由授权服务器处理，应用程序无需关心任何特定认证机制的实现细节。这使得授权服务器能够管理用户认证策略，甚至可以在未来更改这些策略，而无需与应用程序协调这些更改。</p>
</div>
<div class="paragraph">
<p>授权层还可以简化资源服务器确定请求是否被授权的方式。传统上，在认证客户端后，每个资源服务器都会评估策略，以确定客户端在每次 API 调用中是否被授权。在分布式系统中，策略需要同步到所有的资源服务器，或者资源服务器必须调用一个中央策略服务器来处理每个请求。在 OAuth 中，策略的评估仅在授权服务器创建新的访问令牌时进行。如果授权访问在访问令牌中得到体现，资源服务器就不再需要评估策略，而只需要验证访问令牌。这种简化适用于应用程序代表资源所有者行事，或者代表自身行事的情况。</p>
</div>
<div class="paragraph">
<p>OAuth 是一个授权协议，而不是一个认证协议。访问令牌代表授予客户端的授权。客户端将访问令牌呈现给专有 API 并获取资源所有者的用户标识符，然后将 API 的结果用作用户认证的代理，这是一种常见做法。这种做法不属于 OAuth 标准或安全考虑范围，可能未得到资源所有者的考虑。实施者在采用这种做法之前，应仔细查阅资源服务器的文档。</p>
</div>
<div class="paragraph">
<p>本规范是为与 HTTP [<a href="12-references.html#RFC9110" class="xref page">RFC9110</a>] 一起使用而设计的。在除 HTTP 之外的任何协议上使用 OAuth 超出了本规范的范围。</p>
</div>
<div class="paragraph">
<p>自 2012 年 10 月发布 OAuth 2.0 授权框架 [<a href="12-references.html#RFC6749" class="xref page">RFC6749</a>] 以来，它已被 OAuth 2.0 适用于原生应用 [<a href="12-references.html#RFC8252" class="xref page">RFC8252</a>]、OAuth 安全最佳实践 [<a href="12-references.html#I-D.ietf-oauth-security-topics" class="xref page">I-D.ietf-oauth-security-topics</a>] 和适用于基于浏览器的应用程序的 OAuth 2.0 [<a href="12-references.html#I-D.ietf-oauth-browser-based-apps" class="xref page">I-D.ietf-oauth-browser-based-apps</a>] 更新。OAuth 2.0 授权框架：承载令牌使用 [<a href="12-references.html#RFC6750" class="xref page">RFC6750</a>] 也已通过 [<a href="12-references.html#I-D.ietf-oauth-security-topics" class="xref page">I-D.ietf-oauth-security-topics</a>] 更新。本标准轨道规范整合了所有这些文档中的信息，并移除了在 [<a href="12-references.html#I-D.ietf-oauth-security-topics" class="xref page">I-D.ietf-oauth-security-topics</a>] 中被发现不安全的功能。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="roles"><a class="anchor" href="#roles"></a>1.1.角色</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OAuth 定义了四个角色：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>资源所有者（Resource Owner）</strong>：能够授权访问受保护资源的实体。当资源所有者是人时，被称为最终用户。这有时被缩写为“RO”。</p>
</li>
<li>
<p><strong>资源服务器（Resource Server）</strong>：托管受保护资源的服务器，能够接受并使用访问令牌响应受保护资源的请求。资源服务器通常可以通过 API 访问。这有时被缩写为“RS”。</p>
</li>
<li>
<p><strong>客户端（Client）</strong>：代表资源所有者并获得其授权后请求受保护资源的应用程序。“客户端”一词并不暗示任何特定的实现特征（例如，应用程序是在服务器、桌面还是其他设备上执行）。</p>
</li>
<li>
<p><strong>授权服务器（Authorization Server）</strong>：在成功认证资源所有者并获得授权后，向客户端发放访问令牌的服务器。这有时被缩写为“AS”。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>本规范的大部分内容定义了客户端与授权服务器之间的交互，以及客户端与资源服务器之间的交互。</p>
</div>
<div class="paragraph">
<p>授权服务器与资源服务器之间的交互超出了本规范的范围，然而已经定义了若干扩展，以提供资源服务器与授权服务器之间互操作性的选项。授权服务器可以是资源服务器本身，也可以是一个独立的实体。一个授权服务器可以发放被多个资源服务器接受的访问令牌。</p>
</div>
<div class="paragraph">
<p>资源所有者与授权服务器之间的交互（例如，最终用户如何在授权服务器上进行认证）也超出了本规范的范围，不过有一些例外，例如围绕提示最终用户同意的安全考虑。</p>
</div>
<div class="paragraph">
<p>当资源所有者是最终用户时，用户将与客户端进行交互。当客户端是一个基于网络的应用程序时，用户将通过用户代理（如 [<a href="12-references.html#RFC9110" class="xref page">RFC9110</a>] 第 3.5 节所述）与客户端进行交互。当客户端是一个本地应用程序时，用户将通过操作系统直接与客户端进行交互。更多细节请参阅 <a href="2-client-registration.html#client-types" class="xref page">第2.1节</a>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="protocol-flow"><a class="anchor" href="#protocol-flow"></a>1.2.协议流程</h2>
<div class="sectionbody">
<div id="figure-1" class="listingblock">
<div class="title">图 1：抽象协议流程</div>
<div class="content">
<pre>+--------+                               +---------------+
|        |--(1)--       授权请求       --&gt;|               |
|        |                               |   资源拥有者    |
|        |&lt;-(2)--       授权许可       ---|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(3)--       授权许可       --&gt;|               |
| 客户端  |                               |   授权服务器    |
|        |&lt;-(4)-----    访问令牌   -------|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(5)-----    访问令牌   ------&gt;|               |
|        |                               |   资源服务器    |
|        |&lt;-(6)---      保护资源       ---|               |
+--------+                               +---------------+</pre>
</div>
</div>
<div class="paragraph">
<p><a href="#figure-1">图 1</a> 中所示的抽象 OAuth 2.1 流程描述了四个角色之间的交互，包括以下步骤：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>客户端向资源所有者请求授权</strong>。授权请求可以直接向资源所有者发起（如图所示），或者更理想的方式是通过授权服务器作为中介间接发起。</p>
</li>
<li>
<p><strong>客户端接收授权许可</strong>。授权许可是一种代表资源所有者授权的凭证，使用本规范中定义的授权许可类型之一或使用扩展许可类型来表示。授权许可类型取决于客户端请求授权的方法以及授权服务器支持的类型。</p>
</li>
<li>
<p><strong>客户端通过向授权服务器进行认证并出示授权许可来请求访问令牌</strong>。</p>
</li>
<li>
<p><strong>授权服务器对客户端进行认证并验证授权许可</strong>。如果验证有效，授权服务器将发放访问令牌。</p>
</li>
<li>
<p><strong>客户端向资源服务器请求受保护资源，并通过出示访问令牌进行认证</strong>。</p>
</li>
<li>
<p><strong>资源服务器验证访问令牌</strong>。如果验证有效，资源服务器将处理请求。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>客户端从资源所有者处获得授权许可的首选方法（如步骤 (1) 和 (2) 所示）是使用授权服务器作为中介，这在 <a href="4-grant-types.html#authorization-code-grant" class="xref page">第4.1节</a> 的 <a href="4-grant-types.html#figure-3" class="xref page">图3</a> 中进行了说明。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authorization-grant"><a class="anchor" href="#authorization-grant"></a>1.3.授权许可</h2>
<div class="sectionbody">
<div class="paragraph">
<p>授权许可代表了资源所有者（访问其受保护资源）的授权，客户端使用此授权来获得访问令牌。 本规范定义了三种授权类型——授权码、刷新令牌和客户端凭据，以及用于定义其他类型的可扩展机制。</p>
</div>
<div class="sect2">
<h3 id="authorization-code"><a class="anchor" href="#authorization-code"></a>1.3.1.授权码</h3>
<div class="paragraph">
<p>授权码是用于获得访问令牌的临时凭据。 客户端不是直接从资源所有者请求授权，而是引导资源所有者到授权服务器（通过其用户代理），授权服务器再将资源所有者带回到客户端，并附上授权码。 然后，客户端可以用授权码换取访问令牌。</p>
</div>
<div class="paragraph">
<p>在将资源所有者带回到客户端并附上授权码之前，授权服务器会对资源所有者进行身份验证，并可能会请求资源所有者的同意或以其他方式告知他们客户端的请求。 由于资源所有者只对授权服务器进行身份验证，因此资源所有者的凭据永远不会与客户端共享，并且客户端不需要了解任何额外的身份验证步骤，如多因素身份验证或委托帐户。</p>
</div>
<div class="paragraph">
<p>授权码提供了一些重要的安全优势，例如能够验证客户端，以及能够直接将访问令牌传输到客户端，而无需通过资源所有者的用户代理传递，从而可能将其暴露给其他人（包括资源所有者）。</p>
</div>
</div>
<div class="sect2">
<h3 id="refresh-token"><a class="anchor" href="#refresh-token"></a>1.3.2.刷新令牌</h3>
<div class="paragraph">
<p>刷新令牌是用于获取访问令牌的凭据。 授权服务器可以向客户端颁发刷新令牌，当当前访问令牌无效或过期时，或当需要获取具有相同或更窄范围的其他访问令牌时（访问令牌的生存期可能比资源所有者授权的生存期短，权限也可能更少），可以使用刷新令牌来获取新的访问令牌。 是否颁发刷新令牌由授权服务器自行决定，并且可以根据客户端的属性、请求的属性、授权服务器内的策略或任何其他标准来颁发。如果授权服务器颁发刷新令牌，则在颁发访问令牌时会包含它（即<a href="#figure-2">图2</a>中的步骤（2））。</p>
</div>
<div class="paragraph">
<p>刷新令牌是一个字符串，代表资源所有者授予客户端的授权。 对于客户端而言，该字符串是不透明的。 刷新令牌可以是用于检索授权信息的标识符，也可以将此信息编码到字符串本身中。 与访问令牌不同，刷新令牌仅供授权服务器使用，并且永远不会发送到资源服务器。</p>
</div>
<div id="figure-2" class="listingblock">
<div class="title">图2：刷新过期的访问令牌</div>
<div class="content">
<pre>+--------+                                           +---------------+
|        |--(1)-------         授权许可     ---------&gt;|               |
|        |                                           |               |
|        |&lt;-(2)-----------     访问令牌  -------------|               |
|        |                   &amp; 刷新令牌               |               |
|        |                                           |               |
|        |                            +----------+   |               |
|        |--(3)----    访问令牌   ----&gt;|           |   |              |
|        |                            |          |   |               |
|        |&lt;-(4)-      受保护资源     --|           |   |               |
| 客户端  |                            | 资源服务器 |   |   授权服务器   |
|        |--(5)----    访问令牌   ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(6)-     无效令牌错误      -|          |   |               |
|        |                            +----------+   |               |
|        |                                           |               |
|        |--(7)-----------     刷新令牌   -----------&gt;|               |
|        |                                           |               |
|        |&lt;-(8)-----------     访问令牌  -------------|               |
+--------+                  &amp; 可选刷新令牌             +---------------+</pre>
</div>
</div>
<div class="paragraph">
<p><a href="#figure-2">图2</a> 中所示的流程包括以下步骤：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>客户端通过向授权服务器进行身份验证并出示授权许可来请求访问令牌。</p>
</li>
<li>
<p>授权服务器对客户端进行身份验证并验证授权许可，如果有效，则颁发访问令牌，并可选地颁发刷新令牌。</p>
</li>
<li>
<p>客户端通过出示访问令牌向资源服务器发出受保护资源请求。</p>
</li>
<li>
<p>资源服务器验证访问令牌，如果有效，则处理请求。</p>
</li>
<li>
<p>步骤（3）和（4）重复进行，直到访问令牌过期。如果客户端知道访问令牌已过期，则跳转到步骤（7）；否则，它将发出另一个受保护资源请求。</p>
</li>
<li>
<p>由于访问令牌无效，资源服务器返回无效令牌错误。</p>
</li>
<li>
<p>如果已颁发凭据，则客户端通过出示刷新令牌并提供客户端身份验证来请求新的访问令牌。客户端身份验证要求基于客户端类型和授权服务器策略。</p>
</li>
<li>
<p>授权服务器对客户端进行身份验证并验证刷新令牌，如果有效，则颁发新的访问令牌（以及可选地颁发新的刷新令牌）。</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="client-credentials"><a class="anchor" href="#client-credentials"></a>1.3.3.客户端凭证</h3>
<div class="paragraph">
<p>当授权范围仅限于客户端控制下的受保护资源，或与授权服务器事先安排的受保护资源时，客户端凭证或其他形式的客户端身份验证（例如，用于签署JWT的私钥，如[<a href="12-references.html#RFC7523" class="xref page">RFC7523</a>]所述）可用作授权授权码。当客户端基于与授权服务器事先安排的授权请求访问受保护资源时，将使用客户端凭证。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="access-token"><a class="anchor" href="#access-token"></a>1.4.访问令牌</h2>
<div class="sectionbody">
<div class="paragraph">
<p>访问令牌是用于访问受保护资源的凭据。访问令牌是一个字符串，代表授权服务器颁发给客户端的授权。</p>
</div>
<div class="paragraph">
<p>即使访问令牌具有结构，客户端也应将其视为不透明的。客户端不得期望能够解析访问令牌的值。授权服务器无需使用除资源服务器预期之外的统一访问令牌编码或格式。</p>
</div>
<div class="paragraph">
<p>访问令牌代表资源所有者授予的特定访问范围和持续时间，并由资源服务器和授权服务器强制执行。</p>
</div>
<div class="paragraph">
<p>根据授权服务器的实现，资源服务器可以使用令牌字符串来检索授权信息，或者令牌可以以一种可验证的方式（即，由签名数据有效载荷组成的令牌字符串）自行包含授权信息。令牌检索机制的一个示例是令牌内省[<a href="12-references.html#RFC7662" class="xref page">RFC7662</a>]，其中资源服务器调用授权服务器上的端点来验证客户端提供的令牌。结构化令牌格式的一个示例是访问令牌的JWT配置文件[<a href="12-references.html#RFC9068" class="xref page">RFC9068</a>]，这是一种将访问令牌数据编码和签名为JSON Web Token [<a href="12-references.html#RFC7519" class="xref page">RFC7519</a>]的方法。</p>
</div>
<div class="paragraph">
<p>为了使客户端能够使用访问令牌，可能需要额外的身份验证凭据，这些凭据超出了本规范的范围。这通常称为发送方受限访问令牌，例如DPoP [<a href="12-references.html#RFC9449" class="xref page">RFC9449</a>]和相互TLS证书绑定访问令牌[<a href="12-references.html#RFC8705" class="xref page">RFC8705</a>]。</p>
</div>
<div class="paragraph">
<p>访问令牌提供了一个抽象层，用资源服务器理解的单个令牌替换了不同的授权构造（例如，用户名和密码）。这种抽象使得能够发出比用于获取它们的授权授权码更具限制性的访问令牌，同时消除了资源服务器需要理解各种身份验证方法的需求。</p>
</div>
<div class="paragraph">
<p>基于资源服务器的安全要求，访问令牌可以具有不同的格式、结构和利用方法（例如，密码学属性）。访问令牌属性和用于访问受保护资源的方法可以扩展超出本规范中所述的内容。</p>
</div>
<div class="paragraph">
<p>访问令牌（以及任何机密访问令牌属性）在传输和存储过程中必须保密，并且只能在授权服务器、访问令牌有效的资源服务器以及向其颁发访问令牌的客户端之间共享。</p>
</div>
<div class="paragraph">
<p>授权服务器必须确保访问令牌不能被未经授权的方生成、修改或猜测以产生有效的访问令牌。</p>
</div>
<div class="sect2">
<h3 id="access-token-scope"><a class="anchor" href="#access-token-scope"></a>1.4.1.访问令牌范围</h3>
<div class="paragraph">
<p>访问令牌旨在颁发给权限低于授予访问权限的用户的客户端。这被称为有限“范围”访问令牌。授权服务器和资源服务器可以使用此范围机制来限制特定客户端可以访问的资源类型或访问级别。</p>
</div>
<div class="paragraph">
<p>例如，客户端可能只需要对用户的资源进行“读取”访问，而不需要更新资源，因此客户端可以请求授权服务器定义的只读范围，并获得一个不能用于更新资源的访问令牌。这需要授权服务器、资源服务器和客户端之间的协调。授权服务器为客户端提供请求特定范围的能力，并将这些范围与颁发给客户端的访问令牌相关联。然后，资源服务器负责在呈现有限范围访问令牌时强制执行范围。</p>
</div>
<div class="paragraph">
<p>OAuth不定义任何范围值，相反，范围由授权服务器或OAuth的扩展或配置文件定义。定义范围的一个此类扩展是[<a href="12-references.html#OpenID" class="xref page">OpenID</a>]，它定义了一组范围，为用户提供对其个人资料信息的细粒度访问。建议避免定义与已知扩展的范围冲突的自定义范围。</p>
</div>
<div class="paragraph">
<p>为了请求有限范围的访问令牌，客户端根据使用的授权类型，在授权或令牌端点使用范围请求参数。反过来，授权服务器使用范围响应参数来通知客户端所颁发访问令牌的范围。</p>
</div>
<div class="paragraph">
<p>范围参数的值表示为空格分隔、区分大小写的字符串列表。字符串由授权服务器定义。如果值包含多个空格分隔的字符串，则它们的顺序不重要，并且每个字符串都会向请求的范围添加额外的访问范围。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    scope       = scope-token *( SP scope-token )
    scope-token = 1*( %x21 / %x23-5B / %x5D-7E )</pre>
</div>
</div>
<div class="paragraph">
<p>授权服务器可以根据授权服务器策略或资源所有者的指令，完全或部分忽略客户端请求的范围。如果颁发的访问令牌范围与客户端请求的范围不同，授权服务器必须在令牌响应（<a href="3-protocol-endpoints.html#token-response" class="xref page">第3.2.3节</a>）中包含范围响应参数，以通知客户端实际授予的范围。</p>
</div>
<div class="paragraph">
<p>如果客户端在请求授权时省略了范围参数，授权服务器必须使用预定义的默认值处理请求，或者因范围无效而拒绝请求。授权服务器应该记录其范围要求和默认值（如果已定义）。</p>
</div>
</div>
<div class="sect2">
<h3 id="bearer-tokens"><a class="anchor" href="#bearer-tokens"></a>1.4.2.Bearer Tokens（持有者令牌）</h3>
<div class="paragraph">
<p>Bearer Token是一种安全令牌，其特性是任何持有该令牌的一方（“持有者”）都可以以任何其他持有该令牌的一方所能使用的任何方式使用该令牌。使用Bearer Token不需要持有者证明拥有加密密钥材料（占有证明）。</p>
</div>
<div class="paragraph">
<p>可以通过占有证明规范（如DPoP [<a href="12-references.html#RFC9449" class="xref page">RFC9449</a>]和mTLS [<a href="12-references.html#RFC8705" class="xref page">RFC8705</a>]）增强Bearer Token，以提供占有证明特性。</p>
</div>
<div class="paragraph">
<p>为防止访问令牌泄露，客户端和资源服务器之间的通信交互必须利用 <a href="#communication-security">第1.5节</a> 中所述的机密性和完整性保护。</p>
</div>
<div class="paragraph">
<p>对Bearer Token的特定结构或格式没有要求。如果Bearer Token是对授权信息的引用，则攻击者必须无法猜测此类引用，例如，通过使用足够长的加密随机字符串。如果Bearer Token使用编码机制在令牌本身中包含授权信息，则访问令牌必须使用足够的完整性保护来防止令牌被修改。有关访问令牌的编码和签名机制的一个示例，请参阅访问令牌的JSON Web Token配置文件[<a href="12-references.html#RFC9068" class="xref page">RFC9068</a>]。</p>
</div>
</div>
<div class="sect2">
<h3 id="sender-constrained-access-t"><a class="anchor" href="#sender-constrained-access-t"></a>1.4.3.Sender-Constrained Access Tokens（发送方受限访问令牌）</h3>
<div class="paragraph">
<p>发送方受限访问令牌将访问令牌的使用绑定到特定发送方。该发送方有义务证明其了解某个机密，这是接收方（例如资源服务器）接受该访问令牌的前提条件。</p>
</div>
<div class="paragraph">
<p>授权服务器和资源服务器应使用发送方受限访问令牌的机制，如OAuth占有证明演示（DPoP）[<a href="12-references.html#RFC9449" class="xref page">RFC9449</a>]或OAuth 2.0的相互TLS[<a href="12-references.html#RFC8705" class="xref page">RFC8705</a>]。请参阅[<a href="12-references.html#I-D.ietf-oauth-security-topics" class="xref page">I-D.ietf-oauth-security-topics</a>]第4.10.1节，以防止被盗和泄露的访问令牌被滥用。</p>
</div>
<div class="paragraph">
<p>建议在客户端和资源服务器之间使用端到端TLS。如果TLS流量需要在中介处终止，请参阅[<a href="12-references.html#I-D.ietf-oauth-security-topics" class="xref page">I-D.ietf-oauth-security-topics</a>]的第4.13节，以获取进一步的安全建议。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="communication-security"><a class="anchor" href="#communication-security"></a>1.5.通信安全</h2>
<div class="sectionbody">
<div class="paragraph">
<p>实现必须使用一种机制来提供通信认证、完整性和保密性，例如传输层安全协议[<a href="12-references.html#RFC8446" class="xref page">RFC8446</a>]，以保护内容或头部字段中明文凭证和令牌的交换，防止窃听、篡改和消息伪造（例如，参见 <a href="2-client-registration.html#client-secret" class="xref page">第2.4.1节</a>、<a href="7-security-considerations.html#authorization-code-injectio" class="xref page">第7.5.1节</a>、<a href="3-protocol-endpoints.html#token-endpoint" class="xref page">第3.2节</a>和 <a href="#bearer-tokens">第1.4.2节</a>）。</p>
</div>
<div class="paragraph">
<p>OAuth URL必须使用https方案，但回环接口重定向URI除外，其可使用http方案。当使用https时，必须根据[<a href="12-references.html#RFC9110" class="xref page">RFC9110</a>]检查TLS证书。在本规范编写之时，TLS 1.3版本[<a href="12-references.html#RFC8446" class="xref page">RFC8446</a>]是最新版本。</p>
</div>
<div class="paragraph">
<p>实现也可以支持符合其安全要求的其他传输层安全机制。</p>
</div>
<div class="paragraph">
<p>本规范不涉及TLS版本和算法的识别。有关传输层安全的最新建议，请参阅[<a href="12-references.html#BCP195" class="xref page">BCP195</a>]，以及有关证书验证和其他安全考虑的相关规范。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http-redirections"><a class="anchor" href="#http-redirections"></a>1.6.HTTP 重定向</h2>
<div class="sectionbody">
<div class="paragraph">
<p>本规范大量使用了 HTTP 重定向，即客户端或授权服务器将资源所有者的用户代理引导至另一个目的地。尽管本规范中的示例显示了 HTTP 302 状态码的使用，但允许使用用户代理可用的任何其他方法（HTTP 307 除外）来完成此重定向，并将其视为实现细节。有关详细信息，请参阅 <a href="7-security-considerations.html#http-307-redirect" class="xref page">第 7.5.4 节</a>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="interoperability"><a class="anchor" href="#interoperability"></a>1.7.互操作性</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OAuth 2.1 提供了一个具有明确定义安全属性的丰富授权框架。</p>
</div>
<div class="paragraph">
<p>本规范将部分或完全未定义一些必需组件（例如，客户端注册、授权服务器功能、端点发现）。其中一些行为在可选扩展中定义，实现可以选择使用这些扩展，例如：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>[<a href="12-references.html#RFC8414" class="xref page">RFC8414</a>]：授权服务器元数据，定义了一个端点，客户端可以使用该端点来查找与特定 OAuth 服务器交互所需的信息</p>
</li>
<li>
<p>[<a href="12-references.html#RFC7591" class="xref page">RFC7591</a>]：动态客户端注册，提供了一种机制，用于通过程序方式向授权服务器注册客户端</p>
</li>
<li>
<p>[<a href="12-references.html#RFC7592" class="xref page">RFC7592</a>]：动态客户端管理，提供了一种机制，用于更新动态注册的客户端信息</p>
</li>
<li>
<p>[<a href="12-references.html#RFC7662" class="xref page">RFC7662</a>]：令牌内省，定义了一种机制，资源服务器可以使用该机制来获取有关访问令牌的信息</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>请参阅 <a href="appendix-d.html" class="xref page">附录 D</a>，了解本规范发布时当前已知扩展的列表。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="compatibility-with-oauth-20"><a class="anchor" href="#compatibility-with-oauth-20"></a>1.8.与 OAuth 2.0 的兼容性</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OAuth 2.1 在应用已知最佳当前实践的扩展和限制的前提下，与 OAuth 2.0 兼容。具体而言，OAuth 2.1 要求使用 OAuth 2.0 核心规范中未指定的功能，例如 PKCE。此外，OAuth 2.1 中未指定 OAuth 2.0 中可用的某些功能，例如隐式授权或资源所有者密码凭证授权类型。此外，OAuth 2.1 对 OAuth 2.0 中允许的一些行为进行了限制，例如 OAuth 2.1 要求对重定向 URI 进行严格字符串匹配。</p>
</div>
<div class="paragraph">
<p>有关与 OAuth 2.0 的差异的更多详细信息，请参阅 <a href="10-differences-from-oauth-20.html" class="xref page">第 10 节</a>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="notational-conventions"><a class="anchor" href="#notational-conventions"></a>1.9.符号约定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>本文档中的关键字“MUST”、“MUST NOT”、“REQUIRED”、“SHALL”、“SHALL NOT”、“SHOULD”、“SHOULD NOT”、“RECOMMENDED”、“NOT RECOMMENDED”、“MAY”和“OPTIONAL”仅在它们全部大写时（如本例所示）才应按照 BCP 14 [<a href="12-references.html#RFC2119" class="xref page">RFC2119</a>] [<a href="12-references.html#RFC8174" class="xref page">RFC8174</a>] 中所述进行解释。</p>
</div>
<div class="paragraph">
<p>本规范使用 [<a href="12-references.html#RFC5234" class="xref page">RFC5234</a>] 中的增强型巴科斯范式（ABNF）表示法。此外，还包含了“统一资源标识符（URI）：通用语法” [<a href="12-references.html#RFC3986" class="xref page">RFC3986</a>] 中的 URI-reference 规则。</p>
</div>
<div class="paragraph">
<p>某些与安全相关的术语应按照 [<a href="12-references.html#RFC4949" class="xref page">RFC4949</a>] 中定义的含义进行理解。这些术语包括但不限于“攻击”、“身份验证”、“授权”、“证书”、“机密性”、“凭据”、“加密”、“身份”、“签名”、“签名验证”、“信任”、“验证”和“核实”。</p>
</div>
<div class="paragraph">
<p>“内容”一词应按照 [<a href="12-references.html#RFC9110" class="xref page">RFC9110</a>] 第 6.4 节中的描述进行解释。</p>
</div>
<div class="paragraph">
<p>“用户代理”一词应按照 [<a href="12-references.html#RFC9110" class="xref page">RFC9110</a>] 第 3.5 节中的描述进行解释。</p>
</div>
<div class="paragraph">
<p>除非另有说明，否则所有协议参数名称和值均区分大小写。</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
