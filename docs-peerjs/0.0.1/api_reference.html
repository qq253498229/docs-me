<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API 参考手册 :: 我的文档</title>
    <link rel="prev" href="get_started.html">
    <link rel="next" href="examples.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">我的文档</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false"
              aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">主页</a>
        <a class="navbar-item" href="https://github.com/qq253498229/docs-me">源代码</a>
        <!--        <div class="navbar-item has-dropdown is-hoverable">-->
        <!--          <a class="navbar-link" href="#">Products</a>-->
        <!--          <div class="navbar-dropdown">-->
        <!--            <a class="navbar-item" href="#">Product A</a>-->
        <!--            <a class="navbar-item" href="#">Product B</a>-->
        <!--            <a class="navbar-item" href="#">Product C</a>-->
        <!--          </div>-->
        <!--        </div>-->
        <!--        <div class="navbar-item has-dropdown is-hoverable">-->
        <!--          <a class="navbar-link" href="#">Services</a>-->
        <!--          <div class="navbar-dropdown">-->
        <!--            <a class="navbar-item" href="#">Service A</a>-->
        <!--            <a class="navbar-item" href="#">Service B</a>-->
        <!--            <a class="navbar-item" href="#">Service C</a>-->
        <!--          </div>-->
        <!--        </div>-->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary"
               href="https://github.com/qq253498229/docs-me/releases/download/latest/docs.zip">
             下载
            </a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs-peerjs" data-version="0.0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">PEER JS</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">主页</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="get_started.html">快速开始</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="api_reference.html">API参考手册</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="examples.html">示例</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="peerserver_cloud.html">peer云服务器</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://status.peerjs.com/" target="_blank" rel="noopener">状态页</a></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="team.html">团队</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">PEER JS</span>
    <span class="version">0.0.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../docs-greenworks-js/0.0.1/index.html">Greenworks-JS 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-greenworks-js/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-pd2/0.0.1/index.html">PD2记录</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-pd2/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="index.html">PEER JS</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-actuator/3.3.3/index.html">Spring Boot Actuator</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-actuator/3.3.3/index.html">3.3.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-spring-boot-admin/0.0.1/index.html">SpringBootAdmin文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-spring-boot-admin/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-steamworks-rs/0.11.0/index.html">Steamworks for Rust</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-steamworks-rs/0.11.0/index.html">0.11.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-tauri/v1/index.html">Tauri API 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-tauri/v1/index.html">v1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-testing-angular/中文/start.html">Testing Angular</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-testing-angular/中文/start.html">中文</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-me/0.0.1/index.html">个人记录</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-me/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-taiwu/0.0.1/index.html">太吾绘卷</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-taiwu/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-palworld/0.0.1/index.html">幻兽帕鲁笔记</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-palworld/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../docs-me/0.0.1/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">PEER JS</a></li>
    <li><a href="api_reference.html">API参考手册</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/qq253498229/docs-peerjs/edit/master/modules/ROOT/pages/api_reference.adoc">编辑本页</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="目录" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">API 参考手册</h1>
<div class="sect1">
<h2 id="peer"><a class="anchor" href="#peer"></a>Peer <code>CONSTRUCTOR</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>const peer = new Peer([id], [options]);</pre>
</div>
</div>
<div class="paragraph">
<p>一个peer可以连接到其他peer并监听连接。</p>
</div>
<div class="sect2">
<h3 id="peer-id"><a class="anchor" href="#peer-id"></a>id <code>STRING</code></h3>
<div class="paragraph">
<p>其他peer可以使用提供的ID连接到此peer。如果没有提供ID，将由中介服务器生成一个。ID必须以字母数字字符（小写或大写字母或数字）开头和结尾。 在ID的中间，允许使用短横线（-）和下划线（_）。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
不建议您使用此ID来标识peer，因为它仅用于中介连接。建议您设置 <code><a href="#peerconnect-options">metadata</a></code> 选项以发送其他标识信息。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="peer-options"><a class="anchor" href="#peer-options"></a>options <code>OBJECT</code></h3>
<div class="sect3">
<h4 id="peer-options-key"><a class="anchor" href="#peer-options-key"></a>key <code>STRING</code></h4>
<div class="paragraph">
<p>Peer云服务器的API密钥。这仅用于 <code>0.peerjs.com</code> 以外的服务器。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Peer云服务器在端口443上运行。请确保它没有被阻塞，或者考虑运行您自己的Peer服务器。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-host"><a class="anchor" href="#peer-options-host"></a>host <code>STRING</code></h4>
<div class="paragraph">
<p>服务器主机。默认为 <code>0.peerjs.com</code>。也接受 <code>'/'</code> 来表示相对主机名。</p>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-port"><a class="anchor" href="#peer-options-port"></a>port <code>NUMBER</code></h4>
<div class="paragraph">
<p>服务器端口。默认为 <code>443</code>。</p>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-pinginterval"><a class="anchor" href="#peer-options-pinginterval"></a>pingInterval <code>NUMBER</code></h4>
<div class="paragraph">
<p>Ping间隔（毫秒）。默认为 <code>5000</code>。</p>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-path"><a class="anchor" href="#peer-options-path"></a>path <code>STRING</code></h4>
<div class="paragraph">
<p>您自托管的PeerServer运行的路径。默认为 <code>'/'</code>。</p>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-secure"><a class="anchor" href="#peer-options-secure"></a>secure <code>BOOLEAN</code></h4>
<div class="paragraph">
<p>如果使用SSL，则为 <code>true</code>。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
请注意，我们的云托管服务器和资源可能不支持SSL。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-config"><a class="anchor" href="#peer-options-config"></a>config <code>OBJECT</code></h4>
<div class="paragraph">
<p>传递给RTCPeerConnection的配置哈希。此哈希包含任何自定义ICE/TURN服务器配置。默认为 <code>{ 'iceServers': [{ 'urls': 'stun:stun.l.google.com:19302' }], 'sdpSemantics': 'unified-plan' }</code></p>
</div>
</div>
<div class="sect3">
<h4 id="peer-options-debug"><a class="anchor" href="#peer-options-debug"></a>debug <code>NUMBER</code></h4>
<div class="paragraph">
<p>根据传递的调试级别打印日志消息。默认为 <code>0</code>。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0 不打印日志。</p>
</li>
<li>
<p>1 仅打印错误。</p>
</li>
<li>
<p>2 打印错误和警告。</p>
</li>
<li>
<p>3 打印所有日志。</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerconnect"><a class="anchor" href="#peerconnect"></a>peer.connect <code>METHOD</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>const dataConnection = peer.connect(id, [options]);</pre>
</div>
</div>
<div class="paragraph">
<p>连接到由 <code>id</code> 指定的远程对等方，并返回一个数据连接。请务必监听 <code><a href="#peeron-error">error</a></code> 事件，以防连接失败。</p>
</div>
<div class="sect2">
<h3 id="peerconnect-id"><a class="anchor" href="#peerconnect-id"></a>id <code>STRING</code></h3>
<div class="paragraph">
<p>远程对等方的中介ID（他们的 <code><a href="#peerid">peer.id</a></code>）。</p>
</div>
</div>
<div class="sect2">
<h3 id="peerconnect-options"><a class="anchor" href="#peerconnect-options"></a>options <code>OBJECT</code></h3>
<div class="sect3">
<h4 id="peerconnect-options-label"><a class="anchor" href="#peerconnect-options-label"></a>label <code>STRING</code></h4>
<div class="paragraph">
<p>您希望通过其唯一标识此数据连接的标签。如果未指定，将随机生成一个标签。可以通过 <code><a href="#dataconnection-label">dataConnection.label</a></code> 访问。</p>
</div>
</div>
<div class="sect3">
<h4 id="peerconnect-options-metadata"><a class="anchor" href="#peerconnect-options-metadata"></a>metadata</h4>
<div class="paragraph">
<p>与连接关联的元数据，由发起连接的一方传入。可以通过 <code><a href="#peerconnect-options-metadata">dataConnection.metadata</a></code> 访问。可以是任何可序列化的类型。</p>
</div>
</div>
<div class="sect3">
<h4 id="peerconnect-options-serialization"><a class="anchor" href="#peerconnect-options-serialization"></a>serialization <code>STRING</code></h4>
<div class="paragraph">
<p>可以是 <code>binary</code>（默认）、<code>binary-utf8</code>、<code>json</code> 或 <code>none</code>。可以通过 <code><a href="#dataconnection-serialization">dataConnection.serialization</a></code> 访问。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>binary-utf8</code> 会因为UTF8字符串打包成二进制格式的方式而影响性能。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="peerconnect-options-reliable"><a class="anchor" href="#peerconnect-options-reliable"></a>reliable <code>BOOLEAN</code></h4>
<div class="paragraph">
<p>基础数据通道是否应该可靠（例如，用于大文件传输）或不可靠（例如，用于游戏或流媒体）。默认为 <code>false</code>。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
将reliable设置为true将仅为不兼容的浏览器（仅限Chrome 30及以下版本）使用shim，因此可能无法提供完整性能。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peercall"><a class="anchor" href="#peercall"></a>peer.call <code>METHOD</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>const mediaConnection = peer.call(id, stream, [options]);</pre>
</div>
</div>
<div class="paragraph">
<p>调用由 <code>id</code> 指定的远程对等方，并返回一个媒体连接。如果连接失败，请务必监听 <code><a href="#peeron-error">error</a></code> 事件。</p>
</div>
<div class="sect2">
<h3 id="peercall-id"><a class="anchor" href="#peercall-id"></a>id <code>STRING</code></h3>
<div class="paragraph">
<p>远程对等方的中介ID（即他们的 <code><a href="#peerid">peer.id</a></code>）。</p>
</div>
</div>
<div class="sect2">
<h3 id="peercall-stream"><a class="anchor" href="#peercall-stream"></a>stream <code>MEDIASTREAM</code></h3>
<div class="paragraph">
<p>呼叫者的媒体流</p>
</div>
</div>
<div class="sect2">
<h3 id="peercall-options"><a class="anchor" href="#peercall-options"></a>options <code>OBJECT</code></h3>
<div class="sect3">
<h4 id="peercall-options-metadata"><a class="anchor" href="#peercall-options-metadata"></a>metadata</h4>
<div class="paragraph">
<p>与连接相关的元数据，由发起连接的人传入。可以通过 <code><a href="#mediaconnection-metadata">mediaConnection.metadata</a></code> 访问。可以是任何可序列化的类型。</p>
</div>
</div>
<div class="sect3">
<h4 id="peercall-options-sdptransform"><a class="anchor" href="#peercall-options-sdptransform"></a>sdpTransform <code>METHOD</code></h4>
<div class="paragraph">
<p>在创建offer之前运行的函数，用于修改sdp offer消息。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peeron"><a class="anchor" href="#peeron"></a>peer.on <code>METHOD</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>peer.on(event, callback);</pre>
</div>
</div>
<div class="paragraph">
<p>设置peer事件的监听器。</p>
</div>
<div class="sect2">
<h3 id="peeron-open"><a class="anchor" href="#peeron-open"></a>'open' <code>EVENT</code></h3>
<div class="listingblock">
<div class="content">
<pre>peer.on('open', function(id) { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当与PeerServer建立连接时触发。您可以在此事件触发之前使用peer，但发送给服务器的消息将被排队。<code>id</code> 是peer的中介ID（在构造函数中提供或由服务器分配）。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
如果连接速度很重要，您不应在连接到其他peer之前等待此事件。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="peeron-connection"><a class="anchor" href="#peeron-connection"></a>'connection' <code>EVENT</code></h3>
<div class="listingblock">
<div class="content">
<pre>peer.on('connection', function(dataConnection) { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当与远程peer建立新的数据连接时触发。</p>
</div>
</div>
<div class="sect2">
<h3 id="peeron-call"><a class="anchor" href="#peeron-call"></a>'call' <code>EVENT</code></h3>
<div class="listingblock">
<div class="content">
<pre>peer.on('call', function(mediaConnection) { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当远程peer尝试呼叫您时触发。触发时传入的 <code>mediaConnection</code> 尚未激活；您必须先接听呼叫（<code><a href="#mediaconnection-answer">mediaConnection.answer([stream]</a></code>);）。然后，您可以监听 <code><a href="#mediaconnection-on">stream</a></code> 事件。</p>
</div>
</div>
<div class="sect2">
<h3 id="peeron-close"><a class="anchor" href="#peeron-close"></a>'close' <code>EVENT</code></h3>
<div class="listingblock">
<div class="content">
<pre>peer.on('close', function() { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当peer被 <code><a href="#peerdestroy">destroyed</a></code> 且无法再接受或创建任何新连接时触发。此时，peer的所有连接都将被关闭。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
为确保peer正确清理，我们建议在不再需要peer时调用 <code>peer.destroy()</code>。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="peeron-disconnected"><a class="anchor" href="#peeron-disconnected"></a>'disconnected' <code>EVENT</code></h3>
<div class="listingblock">
<div class="content">
<pre>peer.on('disconnected', function() { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当peer与信令服务器断开连接时触发，可能是 <a href="#peerdisconnect">手动断开连接</a>，也可能是因为与信令服务器的连接丢失。当peer断开连接时，其现有连接将保持活动状态，但peer无法接受或创建任何新连接。您可以通过调用 `<a href="#peerreconnect">peer.reconnect()</a>`重新连接到服务器。</p>
</div>
</div>
<div class="sect2">
<h3 id="peeron-error"><a class="anchor" href="#peeron-error"></a>'error' <code>EVENT</code></h3>
<div class="listingblock">
<div class="content">
<pre>peer.on('error', function(err) { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>peer上的错误<strong>几乎总是致命的</strong>，并将销毁peer。来自底层socket和PeerConnections的错误将转发到此处。</p>
</div>
<div class="paragraph">
<p>这些错误具有以下 <code>err.type</code> 类型：</p>
</div>
<div class="sect3">
<h4 id="peeron-error-browser-incompatible"><a class="anchor" href="#peeron-error-browser-incompatible"></a>'browser-incompatible' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>客户端的浏览器不支持您尝试使用的某些或所有WebRTC功能。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-disconnected"><a class="anchor" href="#peeron-error-disconnected"></a>'disconnected' <code>ERROR</code></h4>
<div class="paragraph">
<p>您已经将此peer从服务器断开连接，并且无法再在其上建立任何新连接。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-invalid-id"><a class="anchor" href="#peeron-error-invalid-id"></a>'invalid-id' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>传递给Peer构造函数的ID包含非法字符。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-invalid-key"><a class="anchor" href="#peeron-error-invalid-key"></a>'invalid-key' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>传递给Peer构造函数的API密钥包含非法字符或不在系统中（仅限云服务器）。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-network"><a class="anchor" href="#peeron-error-network"></a>'network' <code>ERROR</code></h4>
<div class="paragraph">
<p>无法建立到信令服务器的连接或连接丢失。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-peer-unavailable"><a class="anchor" href="#peeron-error-peer-unavailable"></a>'peer-unavailable' <code>ERROR</code></h4>
<div class="paragraph">
<p>您尝试连接的peer不存在。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-ssl-unavailable"><a class="anchor" href="#peeron-error-ssl-unavailable"></a>'ssl-unavailable' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>正在安全地使用PeerJS，但云服务器不支持SSL。请使用自定义PeerServer。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-server-error"><a class="anchor" href="#peeron-error-server-error"></a>'server-error' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>无法到达服务器。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-socket-error"><a class="anchor" href="#peeron-error-socket-error"></a>'socket-error' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>来自底层套接字的错误。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-socket-closed"><a class="anchor" href="#peeron-error-socket-closed"></a>'socket-closed' <code>ERROR</code> <code>FATAL</code></h4>
<div class="paragraph">
<p>底层套接字意外关闭。</p>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-unavailable-id"><a class="anchor" href="#peeron-error-unavailable-id"></a>'unavailable-id' <code>ERROR</code> <code>SOMETIMES FATAL</code></h4>
<div class="paragraph">
<p>传递给Peer构造函数的ID已被占用。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
如果您的peer具有开放的peer-to-peer连接，则此错误不是致命的。这可能在您尝试<a href="#peerreconnect">重新连接</a>已 <a href="#peerdisconnect">从服务器断开的</a> peer时发生，但其旧ID现在已被占用。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="peeron-error-webrtc"><a class="anchor" href="#peeron-error-webrtc"></a>'webrtc' <code>ERROR</code></h4>
<div class="paragraph">
<p>原生的WebRTC错误。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerdisconnect"><a class="anchor" href="#peerdisconnect"></a>peer.disconnect <code>METHOD</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>peer.disconnect();</pre>
</div>
</div>
<div class="paragraph">
<p>关闭与服务器的连接，同时保留所有现有的数据和媒体连接。<code><a href="#peerdisconnected">peer.disconnected</a></code> 将被设置为 <code>true</code>，并触发 <code><a href="#peeron-disconnected">disconnected</a></code> 事件。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
此操作不可撤销；相应的对等体对象将不再能够创建或接收任何连接，并且在（云）服务器上，其 ID 将被放弃。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerreconnect"><a class="anchor" href="#peerreconnect"></a>peer.reconnect <code>METHOD</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>peer.reconnect();</pre>
</div>
</div>
<div class="paragraph">
<p>尝试使用对等方的旧ID重新连接到服务器。只有 <a href="#peerdisconnect">已断开的peers</a> 才能重新连接。已销毁的对等方无法重新连接。如果连接失败（例如，如果对等方的旧ID现在已被占用），对等方的现有连接不会关闭，但会触发任何相关的错误事件。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerdestroy"><a class="anchor" href="#peerdestroy"></a>peer.destroy <code>METHOD</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>peer.destroy();</pre>
</div>
</div>
<div class="paragraph">
<p>关闭与服务器的连接并终止所有现有连接。<code><a href="#peerdestroyed">peer.destroyed</a></code> 将被设置为 <code>true</code>。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
此操作不可撤销；相应的对等对象将不再能够创建或接收任何连接，其在（云）服务器上的ID将被没收，并且其所有数据和媒体连接都将被关闭。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerid"><a class="anchor" href="#peerid"></a>peer.id <code>STRING</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>此对等的代理ID。如果在 <a href="#peer">构造函数</a> 中没有指定ID，则在发出<code><a href="#peeron-open">open</a></code>事件之前，此ID将为<code>undefined</code>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerconnections"><a class="anchor" href="#peerconnections"></a>peer.connections <code>OBJECT</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>与此对等关联的所有连接的哈希表，以远程对等的ID为键。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
我们建议您自己跟踪连接，而不是依赖此哈希表。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerdisconnected"><a class="anchor" href="#peerdisconnected"></a>peer.disconnected <code>BOOLEAN</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果与PeerServer存在活动连接，则为<code>false</code>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="peerdestroyed"><a class="anchor" href="#peerdestroyed"></a>peer.destroyed <code>BOOLEAN</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果此对等及其所有连接都不再可用，则为<code>true</code>。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dataconnection"><a class="anchor" href="#dataconnection"></a>DataConnection <code>CLASS</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>封装了WebRTC的DataChannel。要获取一个DataConnection对象，请使用<code><a href="#peerconnect">peer.connect</a></code>或监听<code><a href="#peeron-connection">connect</a></code>事件。</p>
</div>
<div class="sect2">
<h3 id="dataconnection-send"><a class="anchor" href="#dataconnection-send"></a>.send <code>METHOD</code></h3>
<div class="listingblock">
<div class="content">
<pre>dataConnection.send(data);</pre>
</div>
</div>
<div class="paragraph">
<p><code>data</code> 默认通过BinaryPack序列化并发送给远程对等方。</p>
</div>
<div class="sect3">
<h4 id="dataconnection-send-data"><a class="anchor" href="#dataconnection-send-data"></a>data</h4>
<div class="paragraph">
<p>您可以发送任何类型的数据，包括对象、字符串和二进制大对象（blobs）。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-close"><a class="anchor" href="#dataconnection-close"></a>.close <code>METHOD</code></h3>
<div class="listingblock">
<div class="content">
<pre>dataConnection.close();</pre>
</div>
</div>
<div class="paragraph">
<p>优雅地关闭数据连接，清理底层DataChannels和PeerConnections。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-on"><a class="anchor" href="#dataconnection-on"></a>.on <code>METHOD</code></h3>
<div class="listingblock">
<div class="content">
<pre>dataConnection.on(event, callback);</pre>
</div>
</div>
<div class="paragraph">
<p>为数据连接事件设置监听器。</p>
</div>
<div class="sect3">
<h4 id="dataconnection-on-data"><a class="anchor" href="#dataconnection-on-data"></a>'data' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>dataConnection.on('data', function(data) { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当从远程对等方接收到数据时触发。</p>
</div>
</div>
<div class="sect3">
<h4 id="dataconnection-on-open"><a class="anchor" href="#dataconnection-on-open"></a>'open' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>dataConnection.on('open', function() { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当连接建立并可以使用时触发。</p>
</div>
</div>
<div class="sect3">
<h4 id="dataconnection-on-close"><a class="anchor" href="#dataconnection-on-close"></a>'close' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>dataConnection.on('close', function() { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当您或远程对等方关闭数据连接时触发。</p>
</div>
</div>
<div class="sect3">
<h4 id="dataconnection-on-error"><a class="anchor" href="#dataconnection-on-error"></a>'error' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>dataConnection.on('error', function(err) { ... });</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-datachannel"><a class="anchor" href="#dataconnection-datachannel"></a>.dataChannel <code>OBJECT</code></h3>
<div class="paragraph">
<p>与连接关联的RTCDataChannel对象的引用。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-label"><a class="anchor" href="#dataconnection-label"></a>.label <code>LABEL</code></h3>
<div class="paragraph">
<p>连接建立时传入或由PeerJS分配的可选标签。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-metadata"><a class="anchor" href="#dataconnection-metadata"></a>.metadata</h3>
<div class="paragraph">
<p>与连接关联的任何类型的元数据，由发起连接的一方传入。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-open"><a class="anchor" href="#dataconnection-open"></a>.open <code>BOOLEAN</code></h3>
<div class="paragraph">
<p>如果连接已打开并准备好进行读写，则为true。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-peerconnection"><a class="anchor" href="#dataconnection-peerconnection"></a>.peerConnection <code>OBJECT</code></h3>
<div class="paragraph">
<p>与连接关联的RTCPeerConnection对象的引用。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-peer"><a class="anchor" href="#dataconnection-peer"></a>.peer <code>STRING</code></h3>
<div class="paragraph">
<p>此连接另一端的对等方的ID。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-reliable"><a class="anchor" href="#dataconnection-reliable"></a>.reliable <code>BOOLEAN</code></h3>
<div class="paragraph">
<p>底层数据通道是否可靠；在连接建立时定义。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-serialization"><a class="anchor" href="#dataconnection-serialization"></a>.serialization <code>STRING</code></h3>
<div class="paragraph">
<p>通过连接发送的数据的序列化格式。可以是 <code>binary</code>（默认）、<code>binary-utf8</code>、<code>json</code>或<code>none</code>。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-type"><a class="anchor" href="#dataconnection-type"></a>.type <code>STRING</code></h3>
<div class="paragraph">
<p>对于数据连接，此值始终为 <code>'data'</code>。</p>
</div>
</div>
<div class="sect2">
<h3 id="dataconnection-buffersize"><a class="anchor" href="#dataconnection-buffersize"></a>.bufferSize <code>NUMBER</code></h3>
<div class="paragraph">
<p>当浏览器缓冲区不再满时，排队要发送的消息数量。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mediaconnection"><a class="anchor" href="#mediaconnection"></a>MediaConnection <code>CLASS</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>封装WebRTC的媒体流。要获取一个，请使用<code><a href="#peercall">peer.call</a></code>或监听<code><a href="#peeron-call">call</a></code>事件。</p>
</div>
<div class="sect2">
<h3 id="mediaconnection-answer"><a class="anchor" href="#mediaconnection-answer"></a>.answer <code>METHOD</code></h3>
<div class="listingblock">
<div class="content">
<pre>mediaConnection.answer([stream],[options]);</pre>
</div>
</div>
<div class="paragraph">
<p>当在对等体上接收到<code><a href="#peeron-call">call</a></code>事件时，可以调用回调提供的媒体连接上的 <code>.answer</code> 来接受呼叫，并可选地发送自己的媒体流。</p>
</div>
<div class="sect3">
<h4 id="mediaconnection-answer-stream"><a class="anchor" href="#mediaconnection-answer-stream"></a>stream <code>MEDIASTREAM</code></h4>
<div class="paragraph">
<p>来自 <code><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator.getUserMedia">getUserMedia</a></code>的WebRTC媒体流。</p>
</div>
</div>
<div class="sect3">
<h4 id="mediaconnection-answer-options"><a class="anchor" href="#mediaconnection-answer-options"></a>options <code>OBJECT</code></h4>
<div class="sect4">
<h5 id="mediaconnection-answer-options-sdptransform"><a class="anchor" href="#mediaconnection-answer-options-sdptransform"></a>sdpTransform <code>METHOD</code></h5>
<div class="paragraph">
<p>在创建应答之前运行的函数，用于修改sdp应答消息。</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mediaconnection-close"><a class="anchor" href="#mediaconnection-close"></a>.close <code>METHOD</code></h3>
<div class="listingblock">
<div class="content">
<pre>mediaConnection.close();</pre>
</div>
</div>
<div class="paragraph">
<p>关闭媒体连接。</p>
</div>
</div>
<div class="sect2">
<h3 id="mediaconnection-on"><a class="anchor" href="#mediaconnection-on"></a>.on <code>METHOD</code></h3>
<div class="listingblock">
<div class="content">
<pre>mediaConnection.on(event, callback);</pre>
</div>
</div>
<div class="paragraph">
<p>为媒体连接事件设置监听器。</p>
</div>
<div class="sect3">
<h4 id="mediaconnection-on-stream"><a class="anchor" href="#mediaconnection-on-stream"></a>'stream' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>mediaConnection.on('stream', function(stream) { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当远程对等体添加 <code>stream</code> 时触发。</p>
</div>
</div>
<div class="sect3">
<h4 id="mediaconnection-on-close"><a class="anchor" href="#mediaconnection-on-close"></a>'close' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>mediaConnection.on('close', function() { ... });</pre>
</div>
</div>
<div class="paragraph">
<p>当您或远程对等体关闭媒体连接时触发。</p>
</div>
</div>
<div class="sect3">
<h4 id="mediaconnection-on-error"><a class="anchor" href="#mediaconnection-on-error"></a>'error' <code>EVENT</code></h4>
<div class="listingblock">
<div class="content">
<pre>mediaConnection.on('error', function(err) { ... });</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mediaconnection-open"><a class="anchor" href="#mediaconnection-open"></a>.open <code>BOOLEAN</code></h3>
<div class="paragraph">
<p>表示媒体连接是否处于活动状态（例如，您的呼叫已被接听）。如果您想为一方通话设置最大等待时间，可以检查此状态。</p>
</div>
</div>
<div class="sect2">
<h3 id="mediaconnection-metadata"><a class="anchor" href="#mediaconnection-metadata"></a>.metadata</h3>
<div class="paragraph">
<p>与连接相关联的任何类型的元数据，由发起连接的人传递。</p>
</div>
</div>
<div class="sect2">
<h3 id="mediaconnection-peer"><a class="anchor" href="#mediaconnection-peer"></a>.peer <code>STRING</code></h3>
<div class="paragraph">
<p>此连接另一端对等体的ID。</p>
</div>
</div>
<div class="sect2">
<h3 id="mediaconnection-type"><a class="anchor" href="#mediaconnection-type"></a>.type <code>STRING</code></h3>
<div class="paragraph">
<p>对于媒体连接，此值始终为 <code>'media'</code>。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="util"><a class="anchor" href="#util"></a>util <code>OBJECT</code> <code>UTILITY</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>提供多种有用的工具。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
仅文档中记录的工具保证存在于<code>util</code>中。未记录的工具可能会在不发出警告的情况下被移除。我们并不认为这些是“重大更改”。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="util-browser"><a class="anchor" href="#util-browser"></a>.browser <code>STRING</code></h3>
<div class="listingblock">
<div class="content">
<pre>if (util.browser === 'Firefox') { /* 可以与Firefox对等方对等。 */ }</pre>
</div>
</div>
<div class="paragraph">
<p>当前浏览器。<code>util.browser</code> 当前可以有以下值：'firefox'、'chrome'、'safari'、'edge'、'不受支持的浏览器。'、'不是浏览器。'（未知的WebRTC兼容代理）。</p>
</div>
</div>
<div class="sect2">
<h3 id="util-supports"><a class="anchor" href="#util-supports"></a>.supports <code>OBJECT</code></h3>
<div class="listingblock">
<div class="content">
<pre>if (util.supports.data) { /* 可以启动数据连接。 */ }</pre>
</div>
</div>
<div class="paragraph">
<p>WebRTC功能到布尔值的哈希，这些布尔值对应于当前浏览器是否支持该功能。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
仅文档中记录的属性保证存在于<code>util.supports</code>中。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="util-supports-audiovideo"><a class="anchor" href="#util-supports-audiovideo"></a>.audioVideo <code>BOOLEAN</code></h4>
<div class="paragraph">
<p>如果当前浏览器支持媒体流和对等连接，则为true。</p>
</div>
</div>
<div class="sect3">
<h4 id="util-supports-data"><a class="anchor" href="#util-supports-data"></a>.data <code>BOOLEAN</code></h4>
<div class="paragraph">
<p>如果当前浏览器支持DataChannel和对等连接，则为true。</p>
</div>
</div>
<div class="sect3">
<h4 id="util-supports-binary"><a class="anchor" href="#util-supports-binary"></a>.binary <code>BOOLEAN</code></h4>
<div class="paragraph">
<p>如果当前浏览器支持二进制DataChannels，则为true。</p>
</div>
</div>
<div class="sect3">
<h4 id="util-supports-reliable"><a class="anchor" href="#util-supports-reliable"></a>.reliable <code>BOOLEAN</code></h4>
<div class="paragraph">
<p>如果当前浏览器支持可靠DataChannels，则为true。</p>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="get_started.html">快速开始</a></span>
  <span class="next"><a href="examples.html">示例</a></span>
</nav>
</article>
  </div>
</main>
</div>
  </body>
</html>
