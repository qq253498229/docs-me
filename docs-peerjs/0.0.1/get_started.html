<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PeerJS :: 我的文档</title>
    <link rel="prev" href="index.html">
    <link rel="next" href="api_reference.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">我的文档</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false"
              aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">主页</a>
        <a class="navbar-item" href="https://github.com/qq253498229/docs-me">源代码</a>
        <!--        <div class="navbar-item has-dropdown is-hoverable">-->
        <!--          <a class="navbar-link" href="#">Products</a>-->
        <!--          <div class="navbar-dropdown">-->
        <!--            <a class="navbar-item" href="#">Product A</a>-->
        <!--            <a class="navbar-item" href="#">Product B</a>-->
        <!--            <a class="navbar-item" href="#">Product C</a>-->
        <!--          </div>-->
        <!--        </div>-->
        <!--        <div class="navbar-item has-dropdown is-hoverable">-->
        <!--          <a class="navbar-link" href="#">Services</a>-->
        <!--          <div class="navbar-dropdown">-->
        <!--            <a class="navbar-item" href="#">Service A</a>-->
        <!--            <a class="navbar-item" href="#">Service B</a>-->
        <!--            <a class="navbar-item" href="#">Service C</a>-->
        <!--          </div>-->
        <!--        </div>-->
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary"
               href="https://github.com/qq253498229/docs-me/releases/download/latest/docs.zip">
             下载
            </a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs-peerjs" data-version="0.0.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">PEER JS</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">主页</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="get_started.html">快速开始</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api_reference.html">API参考手册</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="examples.html">示例</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="peerserver_cloud.html">peer云服务器</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://status.peerjs.com/" target="_blank" rel="noopener">状态页</a></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="team.html">团队</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">PEER JS</span>
    <span class="version">0.0.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../docs-greenworks-js/0.0.1/index.html">Greenworks-JS 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-greenworks-js/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-neutralino-api/0.0.1/index.html">NeutralinoJS 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-neutralino-api/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-pd2/0.0.1/index.html">PD2记录</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-pd2/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="index.html">PEER JS</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-actuator/3.3.3/index.html">Spring Boot Actuator</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-actuator/3.3.3/index.html">3.3.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-spring-boot-admin/0.0.1/index.html">SpringBootAdmin文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-spring-boot-admin/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-steamworks-rs/0.11.0/index.html">Steamworks for Rust</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-steamworks-rs/0.11.0/index.html">0.11.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-tauri/v1/index.html">Tauri API 文档</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-tauri/v1/index.html">v1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-testing-angular/中文/start.html">Testing Angular</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-testing-angular/中文/start.html">中文</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-me/0.0.1/index.html">个人记录</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-me/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-taiwu/0.0.1/index.html">太吾绘卷</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-taiwu/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../docs-palworld/0.0.1/index.html">幻兽帕鲁笔记</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../docs-palworld/0.0.1/index.html">0.0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../docs-me/0.0.1/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">PEER JS</a></li>
    <li><a href="get_started.html">快速开始</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/qq253498229/docs-peerjs/edit/master/modules/ROOT/pages/get_started.adoc">编辑本页</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="目录" data-levels="3">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">PeerJS</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>PeerJS简化了 peer-to-peer(对等网络) 数据、视频和音频通话。</p>
</div>
<div class="paragraph">
<p>本指南将向您介绍PeerJS API的基本概念。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_配置"><a class="anchor" href="#_配置"></a>配置</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_引入javascript客户端"><a class="anchor" href="#_1_引入javascript客户端"></a>1. 引入Javascript客户端</h3>
<div class="paragraph">
<p>将PeerJS客户端库添加到您的网页中。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"&gt;&lt;/script&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>如果您喜欢，可以自己托管它：<a href="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js">peerjs.min.js</a>，或者 <a href="https://github.com/peers/peerjs">在Github上给我们一个fork</a>。</p>
</div>
</div>
<div class="sect2">
<h3 id="_2_创建peer对象"><a class="anchor" href="#_2_创建peer对象"></a>2. 创建Peer对象</h3>
<div class="paragraph">
<p>Peer对象是我们创建和接收连接的地方。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>var peer = new Peer();</pre>
</div>
</div>
<div class="paragraph">
<p>PeerJS使用PeerServer来处理会话元数据和候选者信令。如果您不喜欢云服务器，也可以运行自己的 <a href="https://github.com/peers/peerjs-server">PeerServer</a>。</p>
</div>
<div class="paragraph">
<p>我们现在已准备好开始建立连接！</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_用法"><a class="anchor" href="#_用法"></a>用法</h2>
<div class="sectionbody">
<div class="paragraph">
<p>每个Peer对象在创建时都会被分配一个随机且唯一的ID。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>peer.on('open', function(id) {
    console.log('My peer ID is: ' + id);
});</pre>
</div>
</div>
<div class="paragraph">
<p>当我们要连接到另一个peer时，我们需要知道他们的peer id。您负责在您的网站用户之间传递peer ID。可选地，您可以将自己的ID传递给Peer构造函数。</p>
</div>
<div class="paragraph">
<p>阅读Peer API参考以获取有关其选项、方法、事件和错误处理的完整信息。</p>
</div>
<div class="sect2">
<h3 id="_数据连接"><a class="anchor" href="#_数据连接"></a>数据连接</h3>
<div class="paragraph">
<p>通过调用 <code>peer.connect</code> 并传入目标peer的peer ID来启动数据连接。每当另一个peer尝试连接到您的peer ID时，您都会收到一个 <code>connection</code> 事件。</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">启动连接</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>var conn = peer.connect('dest-peer-id');</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">接收连接</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>peer.on('connection', function(conn) { ... });</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>peer.connect</code> 和 <code>connection</code> 事件的回调都会提供一个 <code>DataConnection</code> 对象。此对象将允许您发送和接收数据：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>conn.on('open', function() {
    // 接收消息
    conn.on('data', function(data) {
        console.log('Received', data);
    });
    // 发送消息
    conn.send('Hello!');
});</pre>
</div>
</div>
<div class="paragraph">
<p>阅读DataConnection API参考以获取有关其方法和事件的完整详细信息。</p>
</div>
</div>
<div class="sect2">
<h3 id="_视频音频通话"><a class="anchor" href="#_视频音频通话"></a>视频/音频通话</h3>
<div class="paragraph">
<p>通过调用 <code>peer.call</code> 并传入目标peer的peer ID来呼叫另一个peer。当peer呼叫您时，会发出call事件。</p>
</div>
<div class="paragraph">
<p>与数据连接不同，在接收到 <code>call</code> 事件时，必须接听呼叫，否则不会建立连接。</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">开始呼叫</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">var call = peer.call('dest-peer-id', mediaStream);</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">接听呼叫</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">peer.on('call', function(call) {
    // 接听呼叫，提供我们的mediaStream
    call.answer(mediaStream);
});</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>在呼叫或接听呼叫时，应提供MediaStream。MediaStream表示本地视频（摄像头）或音频流，并可以通过某些（特定于浏览器的）版本的 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator.getUserMedia">navigator.getUserMedia</a>获得。在接听呼叫时，MediaStream是可选的，如果没有提供，则会建立单向呼叫。一旦呼叫建立，其 <code>open</code> 属性将设置为true。</p>
</div>
<div class="paragraph">
<p><code>peer.call</code> 和 <code>call</code> 事件的回调提供了一个MediaConnection对象。MediaConnection对象本身会发出一个 <code>stream</code> 事件，其回调包含另一个peer的视频/音频流。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>call.on('stream', function(stream) {
    // `stream` 是远程peer的MediaStream。
    // 您可以在这里将其添加到HTML视频/canvas元素中。
});</pre>
</div>
</div>
<div class="paragraph">
<p>阅读MediaConnection API参考以获取有关其方法和事件的完整详细信息。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_常见问题"><a class="anchor" href="#_常见问题"></a>常见问题</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_我可以发送什么类型的数据"><a class="anchor" href="#_我可以发送什么类型的数据"></a>我可以发送什么类型的数据？</h3>
<div class="paragraph">
<p>PeerJS内置了BinaryPack序列化格式。这意味着您可以发送任何JSON类型以及二进制Blobs和ArrayBuffers。只需发送任意数据，您就可以在另一端接收到它：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>conn.send({
    strings: 'hi!',
    numbers: 150,
    arrays: [1,2,3],
    evenBinary: new Blob([1,2,3]),
    andMore: {bool: true}
});</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_有什么需要注意的吗"><a class="anchor" href="#_有什么需要注意的吗"></a>有什么需要注意的吗？</h3>
<div class="paragraph">
<p>一小部分用户处于对称NAT之后。当两个对称NAT用户尝试相互连接时，NAT遍历是不可能的，无法建立连接。一种解决方法是通过TURN服务器进行连接代理。PeerServer云服务提供了一个免费的TURN服务器。这将使您的PeerJS应用程序能够无缝地处理这种情况</p>
</div>
</div>
<div class="sect2">
<h3 id="_我如何使用turn服务器"><a class="anchor" href="#_我如何使用turn服务器"></a>我如何使用TURN服务器？</h3>
<div class="paragraph">
<p>在创建Peer对象时，将ICE服务器作为选项哈希的config键传递。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>var peer = new Peer({
    config: {'iceServers': [
        { url: 'stun:stun.l.google.com:19302' },
        { url: 'turn:homeo@turn.bistri.com:80', credential: 'homeo' }
    ]} /* 示例服务器，请使用适当的服务器 */
});</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_如果我尝试连接到尚未连接到服务器的peer会怎样"><a class="anchor" href="#_如果我尝试连接到尚未连接到服务器的peer会怎样"></a>如果我尝试连接到尚未连接到服务器的peer会怎样？</h3>
<div class="paragraph">
<p>当您尝试连接到peer时，PeerServer将最多保留5秒钟的连接报价，然后拒绝它。这对于您想要在网页之间快速断开和重新连接时重新连接到peer很有用。</p>
</div>
</div>
<div class="sect2">
<h3 id="_为什么我无法连接"><a class="anchor" href="#_为什么我无法连接"></a>为什么我无法连接？</h3>
<div class="paragraph">
<p>您可能处于对称NAT之后，在这种情况下，您需要设置TURN服务器。</p>
</div>
<div class="paragraph">
<p>另一个可能的问题是您的网络阻止了运行PeerServer云服务的443端口。在这种情况下，您必须使用在适当端口上运行的自己的PeerServer，而不是云服务。</p>
</div>
</div>
<div class="sect2">
<h3 id="_关于延迟带宽怎么样"><a class="anchor" href="#_关于延迟带宽怎么样"></a>关于延迟/带宽怎么样？</h3>
<div class="paragraph">
<p>在两个peer之间发送的数据不会触及任何其他服务器，因此连接速度仅受两个peer的上传和下载速率的限制。这也意味着您没有中间服务器的额外延迟。</p>
</div>
<div class="paragraph">
<p>建立连接的延迟可以分为两个部分：数据的代理和客户端的标识。PeerJS已被设计为最小化您在这两个领域花费的时间。对于代理，数据会通过XHR流式请求发送，然后建立WebSocket连接，之后通过WebSocket发送。对于客户端标识，我们为您提供传入自己的peer ID的能力，从而消除了从服务器检索ID的往返时间。</p>
</div>
</div>
<div class="sect2">
<h3 id="_还有问题吗"><a class="anchor" href="#_还有问题吗"></a>还有问题吗？</h3>
<div class="paragraph">
<p><a href="https://t.me/joinchat/ENhPuhTvhm8WlIxTjQf7Og">在我们的Telegram频道上讨论PeerJS</a>。</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">主页</a></span>
  <span class="next"><a href="api_reference.html">API参考手册</a></span>
</nav>
</article>
  </div>
</main>
</div>
  </body>
</html>
